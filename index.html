<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>績效報告儀表板</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .word-cloud-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }
        .word-cloud-item {
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: bold;
            transition: transform 0.3s ease-in-out;
        }
        .word-cloud-item:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 p-8 font-sans">

    <div id="dashboard" class="container mx-auto bg-white rounded-lg shadow-xl p-8">
        <header class="text-center mb-12 flex flex-wrap justify-center md:justify-between items-center">
            <div class="w-full md:w-auto flex-grow text-center md:text-left mb-4 md:mb-0">
                <h1 class="text-4xl font-extrabold text-blue-800 mb-2">績效報告儀表板</h1>
                <p class="text-xl text-gray-600" id="report-title"></p>
            </div>
            <div class="flex space-x-0 md:space-x-4 w-full md:w-auto">
                <a href="index.html" class="flex-1 md:flex-none px-6 py-2 rounded-lg font-bold bg-blue-600 text-white hover:bg-blue-700 transition duration-300 shadow-md text-center">儀表板</a>
                <a href="dialogue.html" class="flex-1 md:flex-none px-6 py-2 rounded-lg font-bold bg-gray-300 text-gray-800 hover:bg-gray-400 transition duration-300 shadow-md text-center">對話紀錄</a>
            </div>
        </header>

        <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <div class="bg-blue-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-blue-700 mb-2">員工姓名</h2>
                <p class="text-xl font-medium" id="employee-name"></p>
            </div>
            <div class="bg-green-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-green-700 mb-2">績效期間</h2>
                <p class="text-xl font-medium" id="period"></p>
            </div>
            <div class="bg-yellow-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-yellow-700 mb-2">總體評分</h2>
                <div class="flex items-center">
                    <p class="text-4xl font-extrabold text-yellow-600 mr-2" id="overall-score"></p>
                    <p class="text-xl text-gray-500">/ 5 分</p>
                </div>
            </div>
        </section>

        <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-12">
            <div class="bg-indigo-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-indigo-700 mb-2">本季放貸業績</h2>
                <p class="text-xl font-medium" id="kpi-loan-sales"></p>
            </div>
            <div class="bg-purple-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-purple-700 mb-2">基金銷售成長率</h2>
                <p class="text-xl font-medium" id="kpi-fund-growth"></p>
            </div>
        </section>
        
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-orange-700 text-center mb-4">客戶生命週期價值 (CLV) 分析</h2>
                <p class="text-center text-gray-600 mb-4" id="clv-analysis-text"></p>
                <div class="relative h-64 md:h-96">
                    <canvas id="clvChart"></canvas>
                </div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-teal-700 text-center mb-4">知識分享與團隊影響力</h2>
                <div class="relative h-64 md:h-96">
                    <canvas id="teamImpactChart"></canvas>
                </div>
            </div>
        </section>


        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-gray-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-blue-800 border-b-2 border-blue-200 pb-2 mb-4">STAR 框架分析：將行動轉化為商業價值</h2>
                <div id="star-analysis" class="space-y-4 text-gray-700"></div>
            </div>
            <div class="bg-gray-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-green-800 border-b-2 border-green-200 pb-2 mb-4">GROW 框架評估與建議：展望與成長路徑</h2>
                <div id="grow-evaluation" class="space-y-4 text-gray-700"></div>
            </div>
        </section>
        
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-gray-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-blue-800 border-b-2 border-blue-200 pb-2 mb-4">八大能力維度分析</h2>
                <div id="eight-dimensions" class="space-y-4 text-gray-700"></div>
            </div>
            <div class="bg-gray-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-green-800 border-b-2 border-green-200 pb-2 mb-4">黃金對話 Highlight</h2>
                <div id="golden-sentences" class="space-y-4 text-gray-700"></div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-purple-700 text-center mb-4">核心商業能力雷達圖</h2>
                <canvas id="radarChart"></canvas>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-indigo-700 text-center mb-4">關鍵商業行為詞彙雲</h2>
                <div id="wordCloud" class="word-cloud-container"></div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-orange-700 text-center mb-4">影響力與成長潛力散點圖</h2>
                <div class="relative h-64 md:h-96">
                    <canvas id="scatterChart"></canvas>
                </div>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-red-700 text-center mb-4">業務成果與無形價值熱力分析</h2>
                <div class="relative h-64 md:h-96">
                    <canvas id="heatMapChart"></canvas>
                </div>
            </div>
        </section>

        <section class="bg-gray-50 p-6 rounded-lg shadow mb-12">
            <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-gray-200 pb-2 mb-4">下一季行動計畫</h2>
            <ul id="action-plan" class="space-y-2 list-disc list-inside text-gray-700"></ul>
        </section>

        <section class="bg-blue-900 text-white p-8 rounded-lg shadow-xl">
            <h2 class="text-3xl font-bold mb-4">總結與評語：洞見、策略與行動</h2>
            <p class="text-lg leading-relaxed mb-4" id="overall-reason"></p>
        </section>
    </div>

    <script>
        const jsonData = {
          "report_title": "績效報告：洞見、策略與行動",
          "employee_name": "王小明",
          "period": "2025年第一季度",
          "kpis": {
            "q1_loan_sales": 1.25,
            "q1_fund_sales_growth_rate": "25%"
          },
          "clv_analysis": {
            "text": "本季度王小明成功將 3 個舊客戶的平均資產配置規模提升 15%，顯示出其深耕客戶關係的卓越能力。",
            "data": [
                { "name": "新客戶", "value": 70 },
                { "name": "舊客戶", "value": 120 }
            ]
          },
          "team_impact": {
            "labels": ["知識分享次數", "團隊協作分數", "SOP採用率"],
            "data": [5, 4.8, 85]
          },
          "star_analysis": {
            "situation": "在本季度，市場利率波動較大，客戶對貸款與基金產品持觀望態度。同時，面對複雜的客戶財務狀況與跨部門溝通障礙，需要靈活應對。",
            "task": "核心任務為達成放貸與基金銷售雙重目標，並有效處理複雜案件與客訴，同時維繫並開發高資產客戶。",
            "action": "在放貸業務上，你主動透過「說故事」方式向風控部門溝通，解決複雜案件的阻力。在基金銷售上，你從單純產品介紹轉向需求導向溝通與案例分享，有效提升成交率。面對客訴，你展現了高度的情緒管理與溝通技巧，從根本上解決問題。同時，你主動思考如何將經驗系統化，展現了從「解決問題」到「預見問題」的思維轉變。",
            "result": "本季度成功超額完成了放貸與基金銷售的雙重目標。多筆大額貸款順利放款，放貸總額達到 1.25 億，基金銷售的客戶成交數與金額均有顯著成長，成長率達 25%。透過有效的溝通與協調，不僅增強了客戶信任，也提升了部門協作效率，將單一客訴轉化為流程優化機會。"
          },
          "grow_evaluation": {
            "goal": "下一階段目標為不僅是維持現有業績，更要著眼於提升客戶的平均資產規模，並將處理客訴的經驗系統化，轉化為更完善的服務流程與內部知識庫。",
            "reality": "你目前的強項在於執行力與應變能力，但在高資產客戶的開發經驗上相對較少，且對潛在客戶的「洞察力」仍有提升空間。",
            "options": "建議參與高資產客戶維護與開發的內部培訓；與資深同事進行經驗交流，學習如何建立高層次信任關係；在與客戶互動時，練習提出更深層次的問題；將成功經驗撰寫成簡短的SOP，分享給團隊。",
            "will": "你已展現出強烈的成長意願。我相信，只要持續學習與實踐，並將業務思維從「解決」提升到「預見」的層次，將在下一階段取得突破性成就。"
          },
          "next_quarter_plan": [
            "在維持現有業績的基礎上，開發更多高資產客戶。",
            "將處理客訴和跨部門溝通的經驗，整理成一份SOP，分享給團隊。",
            "參與相關的高資產客戶維護與開發培訓。",
            "與資深同事進行經驗交流，學習建立高層次信任關係。"
          ],
          "overall_rating": {
            "score": 4.5,
            "reason": "你的表現超出了我的預期。除了達成甚至超越目標外，你還展現了獨立思考與主動解決問題的能力。特別是你在面對挑戰時的態度，不僅僅是完成任務，更是在其中尋找成長的機會，這一點非常難得。我相信，只要持續學習與實踐，並將業務思維從「解決」提升到「預見」的層次，將在下一階段取得突破性成就。"
          },
          "capabilities": {
            "radar_chart": {
              "跨部門影響力": 4.5,
              "深度客戶洞察": 4.8,
              "客訴機會轉化": 4.7,
              "策略性思維": 3.5,
              "主動性與當責": 3.8
            },
            "scatter_plot": [
              { "capability": "跨部門影響力", "score": 4.5, "improvement": "中" },
              { "capability": "深度客戶洞察", "score": 4.8, "improvement": "低" },
              { "capability": "客訴機會轉化", "score": 4.7, "improvement": "中" },
              { "capability": "策略性思維", "score": 3.5, "improvement": "高" },
              { "capability": "主動性與當責", "score": 3.8, "improvement": "高" }
            ],
            "word_cloud": [
              { "text": "故事化溝通", "value": 25 },
              { "text": "挖掘隱藏需求", "value": 22 },
              { "text": "把客訴變成機會", "value": 28 },
              { "text": "預見問題", "value": 30 },
              { "text": "從修復到預防", "value": 20 },
              { "text": "跨部門賦能", "value": 18 },
              { "text": "銷售非產品是機會", "value": 15 },
              { "text": "高成長性洞察", "value": 14 },
              { "text": "持續性學習意願", "value": 16 }
            ],
            "heat_map": {
              "q1_loan_sales": 5,
              "q1_fund_sales": 4.5,
              "cross_department_collaboration": 4.8,
              "customer_satisfaction": 4.7
            },
            "eight_dimensions": [
                { "dimension": "用淺白語言闡述價值", "score": 9.0, "reason": "員工能將複雜的財務結構故事化，有效向風控部門與客戶溝通，將「非傳統」的收入解釋為「穩定的」資金流向，展現了高超的溝通與轉譯能力。" },
                { "dimension": "梳理對話邏輯", "score": 8.5, "reason": "在與主管的對話中，員工能清晰地闡述從接觸客戶、了解生意模式到與風控溝通的完整過程，邏輯清晰，條理分明。" },
                { "dimension": "回應情緒建立信任", "score": 9.5, "reason": "在處理客訴和基金客戶時，員工優先關注客戶的情緒和背後的故事（父親投資失利），而非僅僅是技術性問題，這大大增強了客戶的信任感。" },
                { "dimension": "精準解決方案疑慮", "score": 9.0, "reason": "員工沒有直接與風控經理爭辯SOP，而是透過製作專屬報告並親自溝通，精準解決了部門的疑慮，展現了高效率的問題解決能力。" },
                { "dimension": "數據佐證效益", "score": 7.0, "reason": "對話提到了「數字很不錯」，但主要焦點在於行為與故事。雖然結果導向，但在對話中較少直接用具體數字來佐證每一次行動，有進一步強化的空間。" },
                { "dimension": "風險對比凸顯保障", "score": 9.5, "reason": "員工在與基金客戶溝通時，沒有直接推銷，而是透過「穩健資產配置」的成功案例，有效對比了風險與長期保障，降低了客戶的心理抗拒。" },
                { "dimension": "案例分享增說服力", "score": 9.0, "reason": "員工巧妙地運用「與我年紀相仿」的客戶案例，讓新客戶產生強烈共鳴，將抽象的產品優勢轉化為具體的目標實現，說服力極強。" },
                { "dimension": "主動學習與成長意願", "score": 10.0, "reason": "員工在面談中主動提出要將經驗整理成SOP並分享給團隊，以及希望開發高資產客戶，展現了極高的自我驅動與成長意願，這也是主管給予最高評價的原因。" }
            ],
            "golden_sentences": [
                { "sentence": "數字背後的故事，我更想聽你親口說說。", "category": "啟發式提問", "explanation": "引導員工從單純的數字思維轉向行為與故事思維，挖掘績效背後的高價值行動。" },
                { "sentence": "我沒有直接用制式的資料去說服，而是花時間跟客戶深聊，了解他們實際的生意模式和資金流向。", "category": "深度客戶洞察", "explanation": "展現員工不只關注表面資料，更能主動挖掘客戶的真實需求與營運模式，是高層次業務能力的體現。" },
                { "sentence": "我沒跟他爭論SOP，我先承認他的專業和考量，然後我說：「經理，我知道您的顧慮，但我認為這家公司的成長性很強...」", "category": "高情商溝通", "explanation": "展現員工在面對阻力時，不與之正面衝突，而是先認可對方，再以利他角度切入，有效化解矛盾。" },
                { "sentence": "我問他：「您之前是不是有什麼投資經驗，讓您對風險特別敏感？」", "category": "挖掘隱藏需求", "explanation": "這是一個精準的提問，直指客戶猶豫的根源，是從「推銷」轉向「解決問題」的關鍵步驟。" },
                { "sentence": "我認為最高境界是「把客訴變成機會」。", "category": "思維模式轉變", "explanation": "這是主管為員工提出的更高層次期待，也總結了員工從「解決問題」到「預見問題」的思維轉變，極具指導性。" }
            ]
          }
        };

        // Renders the data to the HTML document.
        document.addEventListener('DOMContentLoaded', () => {
            // Render basic info
            document.getElementById('report-title').textContent = jsonData.report_title;
            document.getElementById('employee-name').textContent = jsonData.employee_name;
            document.getElementById('period').textContent = jsonData.period;
            document.getElementById('overall-score').textContent = jsonData.overall_rating.score;
            document.getElementById('overall-reason').textContent = jsonData.overall_rating.reason;

            // Render KPIs
            document.getElementById('kpi-loan-sales').textContent = jsonData.kpis.q1_loan_sales + ' 億元';
            document.getElementById('kpi-fund-growth').textContent = jsonData.kpis.q1_fund_sales_growth_rate;
            
            // Render Action Plan
            const actionPlanContainer = document.getElementById('action-plan');
            jsonData.next_quarter_plan.forEach(item => {
                const li = document.createElement('li');
                li.textContent = item;
                actionPlanContainer.appendChild(li);
            });

            // Render STAR framework
            const starContainer = document.getElementById('star-analysis');
            const starMap = { "situation": "情境 (Situation)", "task": "任務 (Task)", "action": "行動 (Action)", "result": "結果 (Result)" };
            for (const key in jsonData.star_analysis) {
                starContainer.innerHTML += `
                    <div>
                        <p class="font-bold text-blue-600">${starMap[key]}:</p>
                        <p>${jsonData.star_analysis[key]}</p>
                    </div>
                `;
            }

            // Render GROW framework
            const growContainer = document.getElementById('grow-evaluation');
            const growMap = { "goal": "目標 (Goal)", "reality": "現實 (Reality)", "options": "選擇 (Options)", "will": "意願 (Will)" };
            for (const key in jsonData.grow_evaluation) {
                growContainer.innerHTML += `
                    <div>
                        <p class="font-bold text-green-600">${growMap[key]}:</p>
                        <p>${jsonData.grow_evaluation[key]}</p>
                    </div>
                `;
            }
            
            // Render Eight Dimensions Analysis
            const eightDimContainer = document.getElementById('eight-dimensions');
            jsonData.capabilities.eight_dimensions.forEach(item => {
                eightDimContainer.innerHTML += `
                    <div>
                        <p class="font-bold text-blue-600">${item.dimension}:</p>
                        <p class="mb-2">分數: ${item.score}/10</p>
                        <p>分析: ${item.reason}</p>
                    </div>
                `;
            });

            // Render Golden Sentences
            const goldenSentencesContainer = document.getElementById('golden-sentences');
            jsonData.capabilities.golden_sentences.forEach(item => {
                goldenSentencesContainer.innerHTML += `
                    <div class="bg-gray-100 p-4 rounded-lg">
                        <p class="font-bold text-lg text-gray-800">「${item.sentence}」</p>
                        <p class="text-sm text-gray-500 mt-1">${item.category}</p>
                        <p class="text-gray-700 mt-2">${item.explanation}</p>
                    </div>
                `;
            });

            // Draw Radar Chart
            const radarCtx = document.getElementById('radarChart').getContext('2d');
            const radarValues = Object.values(jsonData.capabilities.radar_chart);
            const radarMin = Math.floor(Math.min(...radarValues) * 10) / 10;
            const radarMax = Math.ceil(Math.max(...radarValues) * 10) / 10;
            new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: Object.keys(jsonData.capabilities.radar_chart),
                    datasets: [{
                        label: '能力評分',
                        data: radarValues,
                        backgroundColor: 'rgba(124, 58, 237, 0.4)',
                        borderColor: 'rgb(124, 58, 237)',
                        borderWidth: 2
                    }]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { font: { size: 12 } },
                            min: radarMin,
                            max: radarMax
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });

            // Draw Scatter Chart
            const scatterCtx = document.getElementById('scatterChart').getContext('2d');
            const improvementColors = { "高": '#dc2626', "中": '#f59e0b', "低": '#10b981' };
            const scatterData = jsonData.capabilities.scatter_plot.map(item => ({
                x: item.score,
                y: item.improvement === '高' ? 1 : item.improvement === '中' ? 2 : 3,
                label: item.capability
            }));
            const pointColors = jsonData.capabilities.scatter_plot.map(item => improvementColors[item.improvement]);
            const scatterScores = scatterData.map(item => item.x);
            const scatterMin = Math.min(...scatterScores);
            const scatterMax = Math.max(...scatterScores);
            new Chart(scatterCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: '能力評分與改善空間',
                        data: scatterData,
                        backgroundColor: pointColors,
                        pointRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: { display: true, text: '能力評分' },
                            min: scatterMin - 0.5, // 再次擴大邊界以確保完整顯示
                            max: scatterMax + 0.5  // 再次擴大邊界以確保完整顯示
                        },
                        y: {
                            type: 'linear',
                            position: 'left',
                            title: { display: true, text: '成長潛力' },
                            min: 0.5, // 確保Y軸數據點不會被切到
                            max: 3.5, // 確保Y軸數據點不會被切到
                            ticks: {
                                callback: function(value, index, values) {
                                    return value === 1 ? '高' : value === 2 ? '中' : '低';
                                }
                            }
                        }
                    },
                    plugins: { tooltip: { callbacks: { label: function(context) { return `${context.raw.label}: ${context.raw.x} 分, 成長潛力: ${context.raw.y === 1 ? '高' : context.raw.y === 2 ? '中' : '低'}`; } } } }
                }
            });
            
            // Draw Heat Map
            const heatMapCtx = document.getElementById('heatMapChart').getContext('2d');
            const heatMapLabels = {
              "q1_loan_sales": "第一季放貸業績",
              "q1_fund_sales": "第一季基金銷售",
              "cross_department_collaboration": "跨部門溝通與協作",
              "customer_satisfaction": "客戶關係維護"
            };
            const heatMapData = Object.keys(jsonData.capabilities.heat_map).map(key => {
                const value = jsonData.capabilities.heat_map[key];
                const color = value >= 4.5 ? '#10b981' : value >= 4 ? '#f59e0b' : '#dc2626';
                return { label: heatMapLabels[key] || key, value: value, color: color };
            });
            const heatMapValues = heatMapData.map(d => d.value);
            const heatMapMax = Math.ceil(Math.max(...heatMapValues) * 10) / 10;
            
            new Chart(heatMapCtx, {
                type: 'bar',
                data: {
                    labels: heatMapData.map(d => d.label),
                    datasets: [{
                        label: '各項評分',
                        data: heatMapValues,
                        backgroundColor: heatMapData.map(d => d.color)
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: { beginAtZero: true, max: heatMapMax, title: { display: true, text: '評分 (1-5)' } },
                        y: { ticks: { font: { size: 12 } } }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            // Render Word Cloud
            const wordCloudContainer = document.getElementById('wordCloud');
            jsonData.capabilities.word_cloud.forEach(word => {
                const span = document.createElement('span');
                const size = 12 + word.value; // Adjust font size based on value
                const opacity = 0.5 + word.value / 40; // Adjust opacity based on value
                const hue = Math.floor(Math.random() * 360); // Random color
                span.textContent = word.text;
                span.className = `word-cloud-item bg-gray-200 text-gray-800`;
                span.style.fontSize = `${size}px`;
                span.style.fontWeight = 'bold';
                span.style.opacity = opacity;
                span.style.backgroundColor = `hsl(${hue}, 70%, 90%)`;
                wordCloudContainer.appendChild(span);
            });
            
            // Draw CLV Chart
            const clvCtx = document.getElementById('clvChart').getContext('2d');
            document.getElementById('clv-analysis-text').textContent = jsonData.clv_analysis.text;
            new Chart(clvCtx, {
                type: 'pie',
                data: {
                    labels: jsonData.clv_analysis.data.map(d => d.name),
                    datasets: [{
                        data: jsonData.clv_analysis.data.map(d => d.value),
                        backgroundColor: ['#f59e0b', '#10b981'],
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.parsed;
                                    return label + ' 萬';
                                }
                            }
                        }
                    }
                }
            });

            // Draw Team Impact Chart
            const teamImpactCtx = document.getElementById('teamImpactChart').getContext('2d');
            new Chart(teamImpactCtx, {
                type: 'bar',
                data: {
                    labels: jsonData.team_impact.labels,
                    datasets: [{
                        label: '團隊貢獻度',
                        data: jsonData.team_impact.data,
                        backgroundColor: ['#3b82f6', '#14b8a6', '#f59e0b'],
                        borderColor: ['#2563eb', '#0d9488', '#d97706'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10,
                            title: {
                                display: true,
                                text: '評分'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        });
    </script>
</body>
</html>