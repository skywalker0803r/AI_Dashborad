<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>績效報告儀表板</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .word-cloud-container {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        .word-cloud-item {
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: bold;
            transition: transform 0.3s ease-in-out;
        }
        .word-cloud-item:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 p-8 font-sans">

    <div id="dashboard" class="container mx-auto bg-white rounded-lg shadow-xl p-8">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-extrabold text-blue-800 mb-2">績效報告儀表板</h1>
            <p class="text-xl text-gray-600" id="report-title"></p>
        </header>

        <section class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
            <div class="bg-blue-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-blue-700 mb-2">員工姓名</h2>
                <p class="text-xl font-medium" id="employee-name"></p>
            </div>
            <div class="bg-green-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-green-700 mb-2">績效期間</h2>
                <p class="text-xl font-medium" id="period"></p>
            </div>
            <div class="bg-yellow-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-yellow-700 mb-2">總體評分</h2>
                <div class="flex items-center">
                    <p class="text-4xl font-extrabold text-yellow-600 mr-2" id="overall-score"></p>
                    <p class="text-xl text-gray-500">/ 5 分</p>
                </div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-gray-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-blue-800 border-b-2 border-blue-200 pb-2 mb-4">STAR 框架分析</h2>
                <div id="star-analysis" class="space-y-4 text-gray-700"></div>
            </div>
            <div class="bg-gray-50 p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold text-green-800 border-b-2 border-green-200 pb-2 mb-4">GROW 框架評估與建議</h2>
                <div id="grow-evaluation" class="space-y-4 text-gray-700"></div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-purple-700 text-center mb-4">能力雷達圖</h2>
                <canvas id="radarChart"></canvas>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-indigo-700 text-center mb-4">關鍵詞彙雲</h2>
                <div id="wordCloud" class="word-cloud-container"></div>
            </div>
        </section>

        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-orange-700 text-center mb-4">能力分佈散點圖</h2>
                <canvas id="scatterChart"></canvas>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <h2 class="text-2xl font-bold text-red-700 text-center mb-4">評分熱力分析</h2>
                <canvas id="heatMapChart"></canvas>
            </div>
        </section>

        <section class="bg-blue-900 text-white p-8 rounded-lg shadow-xl">
            <h2 class="text-3xl font-bold mb-4">總結與評語</h2>
            <p class="text-lg leading-relaxed mb-4" id="overall-reason"></p>
        </section>
    </div>

    <script>
        const jsonData = {
          "report_title": "績效報告",
          "employee_name": "王小明",
          "period": "2025年第一季度",
          "star_analysis": {
            "situation": "在本季度，市場利率波動較大，客戶對貸款與基金產品持觀望態度。同時，面對複雜的客戶財務狀況與跨部門溝通障礙，需要靈活應對。",
            "task": "核心任務為達成放貸與基金銷售雙重目標，並有效處理複雜案件與客訴，同時維繫並開發高資產客戶。",
            "action": "在放貸業務上，你主動透過「說故事」方式向風控部門溝通，解決複雜案件的阻力。在基金銷售上，你從單純產品介紹轉向需求導向溝通與案例分享，有效提升成交率。面對客訴，你展現了高度的情緒管理與溝通技巧，從根本上解決問題。同時，你主動思考如何將經驗系統化，展現了從「解決問題」到「預見問題」的思維轉變。",
            "result": "本季度成功超額完成了放貸與基金銷售的雙重目標。多筆大額貸款順利放款，基金銷售的客戶成交數與金額均有顯著成長。透過有效的溝通與協調，不僅增強了客戶信任，也提升了部門協作效率，將單一客訴轉化為流程優化機會。"
          },
          "grow_evaluation": {
            "goal": "下一階段目標為不僅是維持現有業績，更要著眼於提升客戶的平均資產規模，並將處理客訴的經驗系統化，轉化為更完善的服務流程與內部知識庫。",
            "reality": "你目前的強項在於執行力與應變能力，但在高資產客戶的開發經驗上相對較少，且對潛在客戶的「洞察力」仍有提升空間。",
            "options": "建議參與高資產客戶維護與開發的內部培訓；與資深同事進行經驗交流，學習如何建立高層次信任關係；在與客戶互動時，練習提出更深層次的問題；將成功經驗撰寫成簡短的SOP，分享給團隊。",
            "will": "你已展現出強烈的成長意願。我相信，只要持續學習與實踐，並將業務思維從「解決」提升到「預見」的層次，將在下一階段取得突破性成就。"
          },
          "overall_rating": {
            "score": 4.5,
            "reason": "你的表現超出了我的預期。除了達成甚至超越目標外，你還展現了獨立思考與主動解決問題的能力。特別是你在面對挑戰時的態度，不僅僅是完成任務，更是在其中尋找成長的機會，這一點非常難得。"
          },
          "capabilities": {
            "radar_chart": {
              "execution": 4.5,
              "communication": 4.8,
              "problem_solving": 4.7,
              "customer_insight": 3.5,
              "strategic_thinking": 3.8,
              "proactiveness": 4.9
            },
            "scatter_plot": [
              { "capability": "Execution", "score": 4.5, "improvement": "High" },
              { "capability": "Communication", "score": 4.8, "improvement": "Medium" },
              { "capability": "Problem-Solving", "score": 4.7, "improvement": "Medium" },
              { "capability": "Customer-Insight", "score": 3.5, "improvement": "High" },
              { "capability": "Strategic-Thinking", "score": 3.8, "improvement": "High" },
              { "capability": "Proactiveness", "score": 4.9, "improvement": "Low" }
            ],
            "word_cloud": [
              { "text": "主動", "value": 15 },
              { "text": "溝通", "value": 12 },
              { "text": "應變", "value": 10 },
              { "text": "解決問題", "value": 9 },
              { "text": "洞察力", "value": 8 },
              { "text": "協調", "value": 7 },
              { "text": "信任", "value": 6 },
              { "text": "挑戰", "value": 5 },
              { "text": "成長", "value": 5 },
              { "text": "預見", "value": 4 }
            ],
            "heat_map": {
              "q1_loan_sales": 5,
              "q1_fund_sales": 4.5,
              "cross_department_collaboration": 4.8,
              "customer_satisfaction": 4.7
            }
          }
        };

        document.addEventListener('DOMContentLoaded', () => {
            // 渲染基本資訊
            document.getElementById('report-title').textContent = jsonData.report_title;
            document.getElementById('employee-name').textContent = jsonData.employee_name;
            document.getElementById('period').textContent = jsonData.period;
            document.getElementById('overall-score').textContent = jsonData.overall_rating.score;
            document.getElementById('overall-reason').textContent = jsonData.overall_rating.reason;

            // 渲染 STAR 框架
            const starContainer = document.getElementById('star-analysis');
            const starMap = { "S": "情境 (Situation)", "T": "任務 (Task)", "A": "行動 (Action)", "R": "結果 (Result)" };
            for (const key in jsonData.star_analysis) {
                starContainer.innerHTML += `
                    <div>
                        <p class="font-bold text-blue-600">${starMap[key]}:</p>
                        <p>${jsonData.star_analysis[key]}</p>
                    </div>
                `;
            }

            // 渲染 GROW 框架
            const growContainer = document.getElementById('grow-evaluation');
            const growMap = { "G": "目標 (Goal)", "R": "現實 (Reality)", "O": "選擇 (Options)", "W": "意願 (Will)" };
            for (const key in jsonData.grow_evaluation) {
                growContainer.innerHTML += `
                    <div>
                        <p class="font-bold text-green-600">${growMap[key]}:</p>
                        <p>${jsonData.grow_evaluation[key]}</p>
                    </div>
                `;
            }

            // 繪製雷達圖
            const radarCtx = document.getElementById('radarChart').getContext('2d');
            new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: Object.keys(jsonData.capabilities.radar_chart).map(key => key.replace('_', ' ')),
                    datasets: [{
                        label: '能力評分',
                        data: Object.values(jsonData.capabilities.radar_chart),
                        backgroundColor: 'rgba(124, 58, 237, 0.4)',
                        borderColor: 'rgb(124, 58, 237)',
                        borderWidth: 2
                    }]
                },
                options: {
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' },
                            grid: { color: 'rgba(0, 0, 0, 0.1)' },
                            pointLabels: { font: { size: 12 } },
                            min: 0,
                            max: 5
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });

            // 繪製散點圖
            const scatterCtx = document.getElementById('scatterChart').getContext('2d');
            const improvementColors = { "High": '#dc2626', "Medium": '#f59e0b', "Low": '#10b981' };
            const scatterData = jsonData.capabilities.scatter_plot.map(item => ({
                x: item.score,
                y: item.improvement === 'High' ? 1 : item.improvement === 'Medium' ? 2 : 3,
                label: item.capability
            }));
            const pointColors = jsonData.capabilities.scatter_plot.map(item => improvementColors[item.improvement]);

            new Chart(scatterCtx, {
                type: 'scatter',
                data: {
                    datasets: [{
                        label: '能力評分與改善空間',
                        data: scatterData,
                        backgroundColor: pointColors,
                        pointRadius: 8
                    }]
                },
                options: {
                    scales: {
                        x: {
                            type: 'linear',
                            position: 'bottom',
                            title: { display: true, text: '能力評分' },
                            min: 0,
                            max: 5
                        },
                        y: {
                            type: 'linear',
                            position: 'left',
                            title: { display: true, text: '改善空間' },
                            ticks: {
                                callback: function(value, index, values) {
                                    return value === 1 ? '高' : value === 2 ? '中' : '低';
                                }
                            }
                        }
                    },
                    plugins: { tooltip: { callbacks: { label: function(context) { return `${context.raw.label}: ${context.raw.x} 分, 改善空間: ${context.raw.y === 1 ? '高' : context.raw.y === 2 ? '中' : '低'}`; } } } }
                }
            });
            
            // 繪製熱力圖
            const heatMapCtx = document.getElementById('heatMapChart').getContext('2d');
            const heatMapData = Object.keys(jsonData.capabilities.heat_map).map(key => {
                const value = jsonData.capabilities.heat_map[key];
                const color = value >= 4.5 ? '#10b981' : value >= 4 ? '#f59e0b' : '#dc2626';
                return { label: key, value: value, color: color };
            });
            
            new Chart(heatMapCtx, {
                type: 'bar',
                data: {
                    labels: heatMapData.map(d => d.label.replace('_', ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')),
                    datasets: [{
                        label: '各項評分',
                        data: heatMapData.map(d => d.value),
                        backgroundColor: heatMapData.map(d => d.color)
                    }]
                },
                options: {
                    indexAxis: 'y',
                    scales: {
                        x: { beginAtZero: true, max: 5 },
                        y: { ticks: { font: { size: 12 } } }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            // 渲染詞彙雲
            const wordCloudContainer = document.getElementById('wordCloud');
            jsonData.capabilities.word_cloud.forEach(word => {
                const span = document.createElement('span');
                const size = 12 + word.value; // 根據數值調整字體大小
                const opacity = 0.5 + word.value / 20; // 根據數值調整透明度
                const hue = Math.floor(Math.random() * 360); // 隨機顏色
                span.textContent = word.text;
                span.className = `word-cloud-item bg-gray-200 text-gray-800`;
                span.style.fontSize = `${size}px`;
                span.style.fontWeight = 'bold';
                span.style.opacity = opacity;
                span.style.backgroundColor = `hsl(${hue}, 70%, 90%)`;
                wordCloudContainer.appendChild(span);
            });
        });
    </script>

</body>
</html>